<!doctype html>
<html class="theme-next use-motion ">
<head>
  

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />








  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>




<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.5.1"/>




  <meta name="keywords" content="前端性能优化," />





  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.5.1" />


<meta name="description" content="注明: 图片引用自 W3C
TTFB(Time to First Byte)指从客户端开始和服务端交互到服务端开始向客户端浏览器传输数据的时间（包括DNS、socket连接和请求响应时间），是能够反映服务端响应速度的重要指标 
优化：优化DNS查询，使用CDN，提早Flush，添加周期头等
TTDD(Time To Document Download)从服务器加载HTML文档的时间
TTHE(Ti">
<meta property="og:type" content="article">
<meta property="og:title" content="什么是浏览器关键时间点？">
<meta property="og:url" content="http://zhangmhao.github.io/2014/05/20/浏览器关键时间点/index.html">
<meta property="og:site_name" content="Code Me">
<meta property="og:description" content="注明: 图片引用自 W3C
TTFB(Time to First Byte)指从客户端开始和服务端交互到服务端开始向客户端浏览器传输数据的时间（包括DNS、socket连接和请求响应时间），是能够反映服务端响应速度的重要指标 
优化：优化DNS查询，使用CDN，提早Flush，添加周期头等
TTDD(Time To Document Download)从服务器加载HTML文档的时间
TTHE(Ti">
<meta property="og:image" content="http://www.w3.org/TR/navigation-timing/timing-overview.png">
<meta property="og:image" content="https://developers.google.com/web/fundamentals/performance/critical-rendering-path/images/dom-navtiming.png">
<meta property="og:image" content="https://developer.chrome.com/devtools/docs/network-files/dom-lines.png">
<meta property="og:updated_time" content="2015-09-22T13:55:45.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="什么是浏览器关键时间点？">
<meta name="twitter:description" content="注明: 图片引用自 W3C
TTFB(Time to First Byte)指从客户端开始和服务端交互到服务端开始向客户端浏览器传输数据的时间（包括DNS、socket连接和请求响应时间），是能够反映服务端响应速度的重要指标 
优化：优化DNS查询，使用CDN，提早Flush，添加周期头等
TTDD(Time To Document Download)从服务器加载HTML文档的时间
TTHE(Ti">


<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: '',
    sidebar: 'post'
  };
</script>

  <title> 什么是浏览器关键时间点？ | Code Me </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->
  



  <div class="container one-column page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <a href="/" class="brand" rel="start">
      <span class="logo">
        <i class="icon-next-logo"></i>
      </span>
      <span class="site-title">Code Me</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            <i class="menu-item-icon icon-next-home"></i> <br />
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            <i class="menu-item-icon icon-next-archives"></i> <br />
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            <i class="menu-item-icon icon-next-tags"></i> <br />
            标签
          </a>
        </li>
      

      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content"> 

  <div id="posts" class="posts-expand">
    

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              什么是浏览器关键时间点？
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2014-05-20T00:00:00+08:00" content="2014-05-20">
            2014-05-20
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/前端开发/" itemprop="url" rel="index">
                  <span itemprop="name">前端开发</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        <span itemprop="articleBody"><p><img src="http://www.w3.org/TR/navigation-timing/timing-overview.png" alt="enter image description here"></p>
<p>注明: 图片引用自 <a href="http://www.w3.org/TR/navigation-timing/" target="_blank" rel="external">W3C</a></p>
<h3 id="TTFB(Time_to_First_Byte)">TTFB(Time to First Byte)</h3><p>指从客户端开始和服务端交互到服务端开始向客户端浏览器传输数据的时间（包括DNS、socket连接和请求响应时间），是能够反映服务端响应速度的重要指标 </p>
<p>优化：优化DNS查询，使用CDN，提早Flush，添加周期头等</p>
<h3 id="TTDD(Time_To_Document_Download)">TTDD(Time To Document Download)</h3><p>从服务器加载HTML文档的时间</p>
<h3 id="TTHE(Time_To_Head_End)">TTHE(Time To Head End)</h3><p>HTML文档头部解析完成所需要的时间 </p>
<h3 id="TTSR(Time_To_Start_Render)">TTSR(Time To Start Render)</h3><p>定义：浏览器开始渲染的时间，从用户角度出发则可以定义为用户在页面上看到的第一个内容的时间。 即TTSR越短，用户越早浏览器中的内容，心理上的等待时间会越短。</p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Time</span> To <span class="built_in">Start</span> Render: TTSR = TTFB + TTDD + TTHE</span><br></pre></td></tr></table></figure>
<p>其中 <code>TTFB</code>, <code>TTDD</code>,<code>TTHE</code> 在前面提到过了，可以查看前面的介绍；</p>
<p>通过以上公式可以看到<code>TTSR</code>时长主要受以下因素影响， 而且这些因素是开发人员可以控制的，可以通过优化来缩短 <code>TTSR</code> 时长；</p>
<ol>
<li>服务器响应时间</li>
<li>HTML文档的大小</li>
<li>Head中资源使用情况, 是否有脚本阻塞了页面的解析</li>
</ol>
<h3 id="与DOM相关的事件">与DOM相关的事件</h3><p><img src="https://developers.google.com/web/fundamentals/performance/critical-rendering-path/images/dom-navtiming.png" alt="enter image description here"></p>
<blockquote>
<ul>
<li>domLoading：这是整个过程开始的时间戳，浏览器开始解析 HTML 文档第一批收到的字节 document.</li>
<li>domInteractive：标记浏览器完成解析并且所有 HTML 和 DOM 构建完毕的时间点。</li>
<li>domContentLoaded：标记 DOM 准备就绪并且没有样式表阻碍 JavaScript 执行的时间点 - 意味着我们可以开始构建呈现树了。<ul>
<li>很多 JavaScript 框架等待此事件发生后，才开始执行它们自己的逻辑。因此，浏览器会通过捕获 EventStart 和 EventEnd 时间戳，跟踪执行逻辑所需的时间。</li>
</ul>
</li>
<li>domComplete： 顾名思义，所有的处理完成，网页上所有资源（图片等） 下载完成 - 即加载旋转图标停止旋转。</li>
<li>loadEvent：作为每个网页加载的最后一步，浏览器会触发onLoad事件，以便触发附加的应用逻辑。所以onload事件会在 domInteractive、domContentLoaded 和 domComplete 之后触发</li>
</ul>
</blockquote>
<p><code>DomContentLoaded</code> 通常标记 [DOM 和 CSSOM 都准备就绪] 的时间 , 通俗的讲就是：页面解析完成的时间，在高级浏览器里有对应的DOM事件 - <code>DOMContentLoaded</code>，Firefox官方的解析如下：</p>
<blockquote>
<p>Fired at the page’s Document object when parsing of the document is finished. By the time this event fires, the page’s DOM is ready, but the referenced stylesheets, images, and subframesmay not be done loading; use the “load” event to detect a fully-loaded page.</p>
</blockquote>
<p><code>TTSR</code>指标直接决定着用户对页面速度的体验，与此不同，DOM Ready指标并不直接影响感官体验，往往影响的是交互功能何时可用。为何影响的是交互呢？由于<code>DOMContentLoaded</code>事件触发时是所有DOM节点可以进行操作的时候，比如添加事件、增删改节点等，因此用Javascript实现的一些交互功能往往会在DOMContentLoaded事件中去初始化，也只有在<code>DOMContentLoaded</code>事件触发后这项功能才可用。  </p>
<p><img src="https://developer.chrome.com/devtools/docs/network-files/dom-lines.png" alt="enter image description here"></p>
<p>注明：图片来自google developer</p>
<p>这里还要提及的是 <code>DomContentLoaded</code> , <code>DomComplete</code> 这两个时间的差别，网页的Dom内容加载并解析完成时会触发<code>DomContentLoaded</code>，而<code>DomComplete</code>是在网页的资源（css,image等）加载完成后才触发。英文文档原文如下：</p>
<blockquote>
<p> The DOMContentLoaded event is fired when all of the page’s DOM content has been loaded and parsed. The load event is fired once all of the document’s resources (images and CSS files, and so forth) have been fully loaded.</p>
</blockquote>
<h3 id="TTDR_(Time_To_Dom_Ready_)">TTDR (Time To Dom Ready )</h3><figure class="highlight fix"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">TTDR </span>=<span class="string"> TTSR + TTDC + TTST</span></span><br></pre></td></tr></table></figure>
<p>其中：</p>
<ul>
<li><code>TTSR</code>(Time To Start Render)：浏览器开始渲染的时间</li>
<li><code>TTDC</code>(Time To Dom Created)：DOM树创建所耗时间</li>
<li><code>TTST</code>(Time To Script)：BODY中所有脚本加载和执行的时间</li>
</ul>
<p>通过以上公式可以看到Start Render主要受以下因素影响:</p>
<ol>
<li>DOM结构的复杂程度</li>
<li>BODY中脚本运行时间</li>
</ol>
<p>通过对一些实际监控数据的分析得出，在一个通过正常方式加载脚本的页面中，脚本的加载和执行时间往往能占DOM Ready时间的50%左右，由此可见脚本的使用对DOM Ready指标的影响如何的显著！因此，对DOM Ready指标的优化也应该着重从js脚本的使用入手。 </p>
<p>当然，随着硬件性能越来越高，脚本的执行时间对于页面加载速度的影响会越来越少；但是，如果有构建一个60fps的web应用，细节往往是非常重要的</p>
<h3 id="TTI(time_to_interact)">TTI(time to interact)</h3><p>TTI(Time To Interact)指的是页面可交互的时间。页面中的交互包括很多方面，例如点击一个链接、点击一个搜索按钮都属于页面交互的范畴，但是对于衡量性能的TTI则主要指核心功能可以交互的时间。核心功能的定义则是随着页面的不同而不同，例如对于百度首页而言，最为关键的就是搜索框出现的时间、而对于一些购物网站的商品详情页最关键的是购买功能可用和描述出现的时间。而目前的实际情况，TTI大都等于DOM Ready时间，因为不论交互功能是否重要，相关的Javascript都会在DOM Ready后才进行初始化和绑定，而实际上TTI是可以更早的。  </p>
<p>通过TTI的定义可以知道，TTI的长短对于用户体验的影响是十分重要的，它影响着用户对核心功能的使用。</p>
<ol>
<li>Start Render时间 - 只有内容开始渲染了，接下来才有可能提供可交互的界面，因此渲染时间的快与慢会直接影响TTI时间。</li>
<li>核心功能相关HTML元素的显示时间 ， 决定着核心功能对用户可见的时间</li>
<li>提供用户交互的JS脚本什么时候执行完成 ， 决定着核心Javascript功能可交互的时间</li>
</ol>
<p>在HTML5应用中，JS模板引擎的使用是非常普遍的，这个使用得好可以提高TTI时间，使用得不好，会比没有使用模板引擎而是通过后端模板引擎渲染的页面更慢。客户端使用JS模板引擎进行渲染的过程必须知会用户，然用户不至于见到一个空白页面，这个在我之前做过的一个项目，UC视频就是一个很好的反例。</p>
<h3 id="参考：">参考：</h3><ol>
<li><a href="http://www.cnblogs.com/onflying/archive/2013/04/23/3037789.html" target="_blank" rel="external">http://www.cnblogs.com/onflying/archive/2013/04/23/3037789.html</a> </li>
<li><a href="http://www.w3.org/2010/webperf/" target="_blank" rel="external">http://www.w3.org/2010/webperf/</a>  </li>
<li><a href="https://developer.mozilla.org/en-US/docs/Navigation_timing" target="_blank" rel="external">https://developer.mozilla.org/en-US/docs/Navigation_timing</a> </li>
<li><a href="http://nunumick.me/blog/2011/02/23/web-page-speed-metrics.html" target="_blank" rel="external">http://nunumick.me/blog/2011/02/23/web-page-speed-metrics.html</a>  </li>
<li><a href="http://zh.wikipedia.org/wiki/%E5%B8%A7%E7%8E%87" target="_blank" rel="external">http://zh.wikipedia.org/wiki/%E5%B8%A7%E7%8E%87</a>  </li>
<li><a href="http://addyosmani.com/blog/performance-optimisation-with-timeline-profiles/" target="_blank" rel="external">http://addyosmani.com/blog/performance-optimisation-with-timeline-profiles/</a> </li>
<li><a href="http://blog.chromium.org/2012/11/build-smoother-web-apps-with-chrome.html" target="_blank" rel="external">http://blog.chromium.org/2012/11/build-smoother-web-apps-with-chrome.html</a> </li>
<li><a href="http://www.w3.org/TR/navigation-timing/" target="_blank" rel="external">http://www.w3.org/TR/navigation-timing/</a></li>
<li><a href="https://developer.chrome.com/devtools/docs/network" target="_blank" rel="external">https://developer.chrome.com/devtools/docs/network</a></li>
</ol>
</span>
      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/前端性能优化/" rel="tag">#前端性能优化</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-prev post-nav-item">
            
              <a href="/2014/06/02/由橡皮鸭到Code-Review/" rel="prev">由橡皮鸭到Code-Review</a>
            
          </div>

          <div class="post-nav-next post-nav-item">
            
              <a href="/2014/05/07/命令空間與模塊加載器的異同/" rel="next">命令空间与模块加载器的异同</a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

 </div>

        

        
          <div class="comments" id="comments">
            
          </div>
        
      </div>

      
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="/images/default_avatar.jpg" alt="Andrew Zhang" itemprop="image"/>
          <p class="site-author-name" itemprop="name">Andrew Zhang</p>
        </div>
        <p class="site-description motion-element" itemprop="description"></p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">40</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            
              <span class="site-state-item-count">10</span>
              <span class="site-state-item-name">分类</span>
              
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">28</span>
              <span class="site-state-item-name">标签</span>
              </a>
          </div>

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      
        <section class="post-toc-wrap sidebar-panel-active">
          <div class="post-toc-indicator-top post-toc-indicator"></div>
          <div class="post-toc">
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#TTFB(Time_to_First_Byte)"><span class="nav-number">1.</span> <span class="nav-text">TTFB(Time to First Byte)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TTDD(Time_To_Document_Download)"><span class="nav-number">2.</span> <span class="nav-text">TTDD(Time To Document Download)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TTHE(Time_To_Head_End)"><span class="nav-number">3.</span> <span class="nav-text">TTHE(Time To Head End)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TTSR(Time_To_Start_Render)"><span class="nav-number">4.</span> <span class="nav-text">TTSR(Time To Start Render)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#与DOM相关的事件"><span class="nav-number">5.</span> <span class="nav-text">与DOM相关的事件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TTDR_(Time_To_Dom_Ready_)"><span class="nav-number">6.</span> <span class="nav-text">TTDR (Time To Dom Ready )</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TTI(time_to_interact)"><span class="nav-number">7.</span> <span class="nav-text">TTI(time to interact)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#参考："><span class="nav-number">8.</span> <span class="nav-text">参考：</span></a></li></ol></div>
            
          </div>
          <div class="post-toc-indicator-bottom post-toc-indicator"></div>
        </section>
      

    </div>
  </aside>


    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner"> <div class="copyright" >
  
  &copy; &nbsp; 
  <span itemprop="copyrightYear">2015</span>
  <span class="with-love">
    <i class="icon-next-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Andrew Zhang</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT
  </a>
</div>


 </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  
  
    
    

  


  
  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.1"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.1"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js?v=0.4.5.1" id="motion.global"></script>




  <script type="text/javascript" src="/js/nav-toggle.js?v=0.4.5.1"></script>
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  
<script type="text/javascript" src="/js/bootstrap.scrollspy.js?v=0.4.5.1" id="bootstrap.scrollspy.custom"></script>


<script type="text/javascript" id="sidebar.toc.highlight">
  $(document).ready(function () {
    var tocSelector = '.post-toc';
    var $tocSelector = $(tocSelector);
    var activeCurrentSelector = '.active-current';

    $tocSelector
      .on('activate.bs.scrollspy', function () {
        var $currentActiveElement = $(tocSelector + ' .active').last();

        removeCurrentActiveClass();
        $currentActiveElement.addClass('active-current');

        $tocSelector[0].scrollTop = $currentActiveElement.position().top;
      })
      .on('clear.bs.scrollspy', function () {
        removeCurrentActiveClass();
      });

    function removeCurrentActiveClass () {
      $(tocSelector + ' ' + activeCurrentSelector)
        .removeClass(activeCurrentSelector.substring(1));
    }

    function processTOC () {
      getTOCMaxHeight();
      toggleTOCOverflowIndicators();
    }

    function getTOCMaxHeight () {
      var height = $('.sidebar').height() -
                   $tocSelector.position().top -
                   $('.post-toc-indicator-bottom').height();

      $tocSelector.css('height', height);

      return height;
    }

    function toggleTOCOverflowIndicators () {
      tocOverflowIndicator(
        '.post-toc-indicator-top',
        $tocSelector.scrollTop() > 0 ? 'show' : 'hide'
      );

      tocOverflowIndicator(
        '.post-toc-indicator-bottom',
        $tocSelector.scrollTop() >= $tocSelector.find('ol').height() - $tocSelector.height() ? 'hide' : 'show'
      )
    }

    $(document).on('sidebar.motion.complete', function () {
      processTOC();
    });

    $('body').scrollspy({ target: tocSelector });
    $(window).on('resize', function () {
      if ( $('.sidebar').hasClass('sidebar-active') ) {
        processTOC();
      }
    });

    onScroll($tocSelector);

    function onScroll (element) {
      element.on('mousewheel DOMMouseScroll', function (event) {
          var oe = event.originalEvent;
          var delta = oe.wheelDelta || -oe.detail;

          this.scrollTop += ( delta < 0 ? 1 : -1 ) * 30;
          event.preventDefault();

          toggleTOCOverflowIndicators();
      });
    }

    function tocOverflowIndicator (indicator, action) {
      var $indicator = $(indicator);
      var opacity = action === 'show' ? 0.4 : 0;
      $indicator.velocity ?
        $indicator.velocity('stop').velocity({
          opacity: opacity
        }, { duration: 100 }) :
        $indicator.stop().animate({
          opacity: opacity
        }, 100);
    }

  });
</script>

<script type="text/javascript" id="sidebar.nav">
  $(document).ready(function () {
    var html = $('html');
    var TAB_ANIMATE_DURATION = 200;
    var hasVelocity = $.isFunction(html.velocity);

    $('.sidebar-nav li').on('click', function () {
      var item = $(this);
      var activeTabClassName = 'sidebar-nav-active';
      var activePanelClassName = 'sidebar-panel-active';
      if (item.hasClass(activeTabClassName)) {
        return;
      }

      var currentTarget = $('.' + activePanelClassName);
      var target = $('.' + item.data('target'));

      hasVelocity ?
        currentTarget.velocity('transition.slideUpOut', TAB_ANIMATE_DURATION, function () {
          target
            .velocity('stop')
            .velocity('transition.slideDownIn', TAB_ANIMATE_DURATION)
            .addClass(activePanelClassName);
        }) :
        currentTarget.animate({ opacity: 0 }, TAB_ANIMATE_DURATION, function () {
          currentTarget.hide();
          target
            .stop()
            .css({'opacity': 0, 'display': 'block'})
            .animate({ opacity: 1 }, TAB_ANIMATE_DURATION, function () {
              currentTarget.removeClass(activePanelClassName);
              target.addClass(activePanelClassName);
            });
        });

      item.siblings().removeClass(activeTabClassName);
      item.addClass(activeTabClassName);
    });

    $('.post-toc a').on('click', function (e) {
      e.preventDefault();
      var targetSelector = escapeSelector(this.getAttribute('href'));
      var offset = $(targetSelector).offset().top;
      hasVelocity ?
        html.velocity('stop').velocity('scroll', {
          offset: offset  + 'px',
          mobileHA: false
        }) :
        $('html, body').stop().animate({
          scrollTop: offset
        }, 500);
    });

    // Expand sidebar on post detail page by default, when post has a toc.
    var $tocContent = $('.post-toc-content');
    if (isDesktop() && CONFIG.sidebar === 'post') {
      if ($tocContent.length > 0 && $tocContent.html().trim().length > 0) {
        displaySidebar();
      }
    }
  });
</script>



  <script type="text/javascript">
    $(document).ready(function () {
      if (CONFIG.sidebar === 'always') {
        displaySidebar();
      }
      if (isMobile()) {
        FastClick.attach(document.body);
      }
    });
  </script>

  

  
  

  
  <script type="text/javascript" src="/js/lazyload.js"></script>
  <script type="text/javascript">
    $(function () {
      $("#posts").find('img').lazyload({
        placeholder: "/images/loading.gif",
        effect: "fadeIn"
      });
    });
  </script>
</body>
</html>
