<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Code Me</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Code Me">
<meta property="og:url" content="http://zhangmhao.github.io/page/4/index.html">
<meta property="og:site_name" content="Code Me">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Code Me">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="Code Me" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Code Me</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://zhangmhao.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/01/01/hello-world/" class="article-date">
  <time datetime="2013-12-31T16:00:00.000Z" itemprop="datePublished">2014-01-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/01/01/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="http://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="http://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick_Start">Quick Start</h2><h3 id="Create_a_new_post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run_server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate_static_files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy_to_remote_sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://zhangmhao.github.io/2014/01/01/hello-world/" data-id="ciepbvo3m003o1bw1qy11zb3k" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-有关前端路由Roter的思考" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2013/12/20/有关前端路由Roter的思考/" class="article-date">
  <time datetime="2013-12-19T16:00:00.000Z" itemprop="datePublished">2013-12-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/前端开发/">前端开发</a>
  </div>

  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在阅读这篇文章 <a href="http://blog.shinetech.com/2013/11/26/backbone-antipatterns/" target="_blank" rel="external">http://blog.shinetech.com/2013/11/26/backbone-antipatterns/</a>  的评论时发现了下面这段评论</p>
<blockquote>
<p>Fantastic writeup. I whole-heartedly agree with all points, although maybe in a different priority order. The only other major one that comes to my mind that I see very frequently is building a stateful application around a Router. If your application needs to manage state, do it with a designated model. Routers should simply be another I/O channel, much like buttons in the display or keys on the keyboard. A router should simply pass-through route data, and update the URL to reflect internal state… However, you should still have a fully functional app without in stanching a router.</p>
</blockquote>
<p>而博主是这样子回答的：</p>
<blockquote>
<p>I agree with your concerns about routers, however I didn’t make an antipattern because I couldn’t clearly articulate my reservations at the time.<br>I have seen problems where people make parts of their app route-driven for no good reason. This causes issues because the router is effectively a global object, with all of the attendant issues that come with globally accessible objects – hard to test, gets bloated, ‘god-class’ tendencies. Doing routes properly is hard. By extension, doing everything with routes makes everything hard.<br>I think it’s important to have a clearly defined policy as to what’s going to have a route and what’s not. In many ways what’s routeable is a UX question first – what needs to be bookmarkable, what needs to be navigable using the back-buttons, what needs SEO – and only secondarily an architectural issue. In my opinion, many people get this around the wrong way.  </p>
</blockquote>
<p>评论的观点是，系统不应该依赖于路由，没有路由，App应该要可以继续正常使用，路由只是App内部状态的一个表示。这个问题我也纠结过，就是应用应不应该通过路由驱动，个人觉得，这个只是一个设计问题罢了，对于web应用来讲，可以通过uri来定位页面资源（弹出窗口等），这个是非常常见的需求，至于路由应不应该成为整个应用的驱动，这个没有什么太大所谓。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://zhangmhao.github.io/2013/12/20/有关前端路由Roter的思考/" data-id="ciepbvo3q003p1bw1w298nwnn" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计/">设计</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-高效率数组去重" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2013/11/21/高效率数组去重/" class="article-date">
  <time datetime="2013-11-20T16:00:00.000Z" itemprop="datePublished">2013-11-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/前端开发/">前端开发</a>
  </div>

  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>最近遇到数组的去重的问题，参考了网上的资料，发觉这个问题涉及到知识点还挺多，不仅仅是js，还有性能优化上的一些权衡，针对一个具体的场景来寻找一个最优的方案，不追求一个函数可以适应所有的场景，因为这样的函数一般性能都不好；</p>
<h3 id="V1:_这是最直接的写法，但是需要2重循环">V1: 这是最直接的写法，但是需要2重循环</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function uniqueV1(arr) &#123;</span><br><span class="line">  <span class="keyword">var</span> <span class="keyword">ret</span> = []</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = 0; i &lt; arr.length; i++) &#123;</span><br><span class="line">    <span class="keyword">var</span> item = arr[i]</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">ret</span>.indexOf(item) === -1) &#123;</span><br><span class="line">      <span class="keyword">ret</span>.push(item)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">ret</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="V2:_通过构建Hash">V2: 通过构建Hash</h3><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uniqueV2</span><span class="params">(arr)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> ret = []</span><br><span class="line">  <span class="keyword">var</span> hash = &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">    <span class="keyword">var</span> item = arr[i]</span><br><span class="line">    <span class="keyword">var</span> key = <span class="keyword">typeof</span>(item) + item</span><br><span class="line">    <span class="keyword">if</span> (hash[key] !== <span class="number">1</span>) &#123;</span><br><span class="line">      ret.push(item)</span><br><span class="line">      hash[key] = <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> ret</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是这个函数无法认出 <code>uniqueV2([ new String(1), new Number(1) ])</code>, 因为这两者的<code>.typeof()</code>的结果都是<code>object</code></p>
<h3 id="V3:_仅仅针对字符串数组的去重">V3: 仅仅针对字符串数组的去重</h3><figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function uniqueV3(arr) &#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="literal">result</span> = &#123;&#125;;</span><br><span class="line">    arr.forEach(function (element) &#123;</span><br><span class="line">        <span class="literal">result</span>[element] = <span class="number">1</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Object</span>.keys(<span class="literal">result</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个函数是高效的，同样无法区分类型，例如下面的例子，无法区分 String 和 Number</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uniqueV3([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>])  返回值 [<span class="string">"1"</span>, <span class="string">"2"</span>, <span class="string">"3"</span>, <span class="string">"4"</span>, <span class="string">"5"</span>]</span><br><span class="line">uniqueV3([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>,<span class="string">'5'</span>]) 返回值 [<span class="string">"1"</span>, <span class="string">"2"</span>, <span class="string">"3"</span>, <span class="string">"4"</span>, <span class="string">"5"</span>]</span><br></pre></td></tr></table></figure>
<h3 id="V4_排序之后再去两两比较进行去重">V4 排序之后再去两两比较进行去重</h3><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uniqueV5</span><span class="params">(results)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> elem,</span><br><span class="line">        duplicates = [],</span><br><span class="line">        hasDuplicate,</span><br><span class="line">        j = <span class="number">0</span>,</span><br><span class="line">        i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> sortOrder = <span class="function"><span class="keyword">function</span><span class="params">( a, b )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ( a === b ) &#123;</span><br><span class="line">            hasDuplicate = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> a - b;</span><br><span class="line">    &#125;;</span><br><span class="line">    results.sort(sortOrder);</span><br><span class="line">    <span class="keyword">if</span> (hasDuplicate) &#123;</span><br><span class="line">        <span class="keyword">while</span> ( (elem = results[i++]) ) &#123;</span><br><span class="line">            <span class="keyword">if</span> ( elem === results[ i ] ) &#123;</span><br><span class="line">                j = duplicates.push( i );</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> ( j-- ) &#123;</span><br><span class="line">            results.splice( duplicates[ j ], <span class="number">1</span> );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> results;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="总结">总结</h2><p>注意： 以上这4个版本的程序没有考虑过浏览器兼容性，如果把这一点也考虑进去，估计有一些点需要重新修改；例如 indexOf在 IE6-8下是没有的。</p>
<blockquote>
<p>针对具体场景寻找一个最优化的解决方案，越简单越好</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://zhangmhao.github.io/2013/11/21/高效率数组去重/" data-id="ciepbvo3y003w1bw19rkds96r" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/性能优化/">性能优化</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-javascript绝句欣赏" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2013/11/07/javascript绝句欣赏/" class="article-date">
  <time datetime="2013-11-06T16:00:00.000Z" itemprop="datePublished">2013-11-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/前端开发/">前端开发</a>
  </div>

  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1. 取整同时转成数值型：</span></span><br><span class="line"><span class="string">'10.567890'</span>|<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//结果: 10</span></span><br><span class="line"></span><br><span class="line"><span class="string">'10.567890'</span>^<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//结果: 10</span></span><br><span class="line"></span><br><span class="line">-<span class="number">2.23456789</span>|<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//结果: -2</span></span><br><span class="line"></span><br><span class="line">~~-<span class="number">2.23456789</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//结果: -2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//2. 日期转数值：</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> d = +<span class="keyword">new</span> <span class="built_in">Date</span>(); <span class="comment">//1295698416792</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//3. 类数组对象转数组：</span></span><br><span class="line"><span class="keyword">var</span> arr = [].slice.call(<span class="built_in">arguments</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//4. 漂亮的随机码：</span></span><br><span class="line"><span class="built_in">Math</span>.random().toString(<span class="number">16</span>).substring(<span class="number">2</span>); <span class="comment">//14位</span></span><br><span class="line"><span class="built_in">Math</span>.random().toString(<span class="number">36</span>).substring(<span class="number">2</span>); <span class="comment">//11位</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//5. 合并数组：</span></span><br><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="keyword">var</span> b = [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>];</span><br><span class="line"><span class="built_in">Array</span>.prototype.push.apply(a, b);</span><br><span class="line">uneval(a); <span class="comment">//[1,2,3,4,5,6]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 6. 用0补全位数：</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">prefixInteger</span>(<span class="params">num, length</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (num / <span class="built_in">Math</span>.pow(<span class="number">10</span>, length)).toFixed(length).substr(<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 7. 交换值：</span></span><br><span class="line">a= [b, b=a][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 8. 将一个数组插入另一个数组的指定位置：</span></span><br><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>];</span><br><span class="line"><span class="keyword">var</span> b = [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>];</span><br><span class="line"><span class="keyword">var</span> insertIndex = <span class="number">3</span>;</span><br><span class="line">a.splice.apply(a, <span class="built_in">Array</span>.concat(insertIndex, <span class="number">0</span>, b));</span><br><span class="line"><span class="comment">// a: 1,2,3,4,5,6,7,8,9</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 9. 删除数组元素：</span></span><br><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</span><br><span class="line">a.splice(<span class="number">3</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 10. 快速取数组最大和最小值</span></span><br><span class="line"><span class="built_in">Math</span>.max.apply(<span class="built_in">Math</span>, [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]) <span class="comment">//3</span></span><br><span class="line"><span class="built_in">Math</span>.min.apply(<span class="built_in">Math</span>, [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]) <span class="comment">//1</span></span><br><span class="line"><span class="comment">//(出自http://ejohn.org/blog/fast-javascript-maxmin/)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 11. 条件判断：</span></span><br><span class="line"><span class="keyword">var</span> a = b &amp;&amp; <span class="number">1</span>;</span><br><span class="line"><span class="comment">// 相当于</span></span><br><span class="line"><span class="keyword">if</span> (b) &#123;</span><br><span class="line">  a = <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = b || <span class="number">1</span>;</span><br><span class="line"><span class="comment">// 相当于</span></span><br><span class="line"><span class="keyword">if</span> (b) &#123;</span><br><span class="line">  a = b;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  a = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">12.</span> 判断IE:</span><br><span class="line"><span class="keyword">var</span> ie = <span class="comment">/*@cc_on !@*/</span><span class="literal">false</span>;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://zhangmhao.github.io/2013/11/07/javascript绝句欣赏/" data-id="ciepbvo3w003t1bw1yluvxk8y" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Javascript的Object比较" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2013/10/31/Javascript的Object比较/" class="article-date">
  <time datetime="2013-10-30T16:00:00.000Z" itemprop="datePublished">2013-10-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/前端开发/">前端开发</a>
  </div>

  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在日常编程中，Object的比较是一个比较常见的问题，没有所谓的可以通用的方法，依旧是具体问题具体分析，在速度和正确性上进行权衡</p>
<h3 id="1-_JSON-stringify_简单快速，有限制">1. <code>JSON.stringify</code> 简单快速，有限制</h3><p>简单快速, 用于比较JSON风格的对象，但是不能有Function和DOM在对象里面</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">JSON</span>.stringify(obj1) === <span class="built_in">JSON</span>.stringify(obj2);</span><br></pre></td></tr></table></figure>
<h3 id="2-_慢一些，却更加普适用">2. 慢一些，却更加普适用</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepCompare</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> i, l, leftChain, rightChain;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">compare2Objects</span> (<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> p;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// remember that NaN === NaN returns false</span></span><br><span class="line">    <span class="comment">// and isNaN(undefined) returns true</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">isNaN</span>(x) &amp;&amp; <span class="built_in">isNaN</span>(y) &amp;&amp; <span class="keyword">typeof</span> x === <span class="string">'number'</span> &amp;&amp; <span class="keyword">typeof</span> y === <span class="string">'number'</span>) &#123;</span><br><span class="line">         <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Compare primitives and functions.     </span></span><br><span class="line">    <span class="comment">// Check if both arguments link to the same object.</span></span><br><span class="line">    <span class="comment">// Especially useful on step when comparing prototypes</span></span><br><span class="line">    <span class="keyword">if</span> (x === y) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Works in case when functions are created in constructor.</span></span><br><span class="line">    <span class="comment">// Comparing dates is a common scenario. Another built-ins?</span></span><br><span class="line">    <span class="comment">// We can even handle functions passed across iframes</span></span><br><span class="line">    <span class="keyword">if</span> ((<span class="keyword">typeof</span> x === <span class="string">'function'</span> &amp;&amp; <span class="keyword">typeof</span> y === <span class="string">'function'</span>) ||</span><br><span class="line">       (x <span class="keyword">instanceof</span> <span class="built_in">Date</span> &amp;&amp; y <span class="keyword">instanceof</span> <span class="built_in">Date</span>) ||</span><br><span class="line">       (x <span class="keyword">instanceof</span> <span class="built_in">RegExp</span> &amp;&amp; y <span class="keyword">instanceof</span> <span class="built_in">RegExp</span>) ||</span><br><span class="line">       (x <span class="keyword">instanceof</span> <span class="built_in">String</span> &amp;&amp; y <span class="keyword">instanceof</span> <span class="built_in">String</span>) ||</span><br><span class="line">       (x <span class="keyword">instanceof</span> <span class="built_in">Number</span> &amp;&amp; y <span class="keyword">instanceof</span> <span class="built_in">Number</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> x.toString() === y.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// At last checking prototypes as good a we can</span></span><br><span class="line">    <span class="keyword">if</span> (!(x <span class="keyword">instanceof</span> <span class="built_in">Object</span> &amp;&amp; y <span class="keyword">instanceof</span> <span class="built_in">Object</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (x.isPrototypeOf(y) || y.isPrototypeOf(x)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (x.constructor !== y.constructor) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (x.prototype !== y.prototype) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check for infinitive linking loops</span></span><br><span class="line">    <span class="keyword">if</span> (leftChain.indexOf(x) &gt; -<span class="number">1</span> || rightChain.indexOf(y) &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">         <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Quick checking of one object beeing a subset of another.</span></span><br><span class="line">    <span class="comment">// <span class="doctag">todo:</span> cache the structure of arguments[0] for performance</span></span><br><span class="line">    <span class="keyword">for</span> (p <span class="keyword">in</span> y) &#123;</span><br><span class="line">        <span class="keyword">if</span> (y.hasOwnProperty(p) !== x.hasOwnProperty(p)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> y[p] !== <span class="keyword">typeof</span> x[p]) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (p <span class="keyword">in</span> x) &#123;</span><br><span class="line">        <span class="keyword">if</span> (y.hasOwnProperty(p) !== x.hasOwnProperty(p)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> y[p] !== <span class="keyword">typeof</span> x[p]) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (<span class="keyword">typeof</span> (x[p])) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'object'</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'function'</span>:</span><br><span class="line"></span><br><span class="line">                leftChain.push(x);</span><br><span class="line">                rightChain.push(y);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (!compare2Objects (x[p], y[p])) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                leftChain.pop();</span><br><span class="line">                rightChain.pop();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">if</span> (x[p] !== y[p]) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">arguments</span>.length &lt; <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">//Die silently? Don't know how to handle such case, please help...</span></span><br><span class="line">    <span class="comment">// throw "Need two or more arguments to compare";</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">1</span>, l = <span class="built_in">arguments</span>.length; i &lt; l; i++) &#123;</span><br><span class="line"></span><br><span class="line">      leftChain = []; <span class="comment">//<span class="doctag">Todo:</span> this can be cached</span></span><br><span class="line">      rightChain = [];</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (!compare2Objects(<span class="built_in">arguments</span>[<span class="number">0</span>], <span class="built_in">arguments</span>[i])) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://zhangmhao.github.io/2013/10/31/Javascript的Object比较/" data-id="ciepbvo4200401bw1izu8trt5" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-前端性能优化总结" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2013/10/15/前端性能优化总结/" class="article-date">
  <time datetime="2013-10-14T16:00:00.000Z" itemprop="datePublished">2013-10-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/前端开发/">前端开发</a>
  </div>

  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>这一段时间一直在做性能优化相关的共工作，做一个总结；关于性能优化这一块，如果从前端的角度来看。</p>
<h3 id="首先要解决的就是页面的大小问题">首先要解决的就是页面的大小问题</h3><p>页面越小，加载速度就越快。而css文件和script文件的位置对页面展现给用户的时间也是影响很大的</p>
<p>总结了一下页面大小优化手段：</p>
<ol>
<li>html尽可能简单（例如减少html标签的嵌套，使用短html标签p,i,ul,li 等等）</li>
<li>不常用的页面采取分页（超链接跳转，需要刷新），或者异步加载的手段（可以免刷新）</li>
<li>线上使用压缩之后的html（可以减少不必要的空格和换行）</li>
<li>css置顶，script置底，script还可以使用defer,async方式控制脚本执行时机</li>
<li>使用前端模板引擎</li>
</ol>
<p>####页面大小问题优化之后就是页面资源网络请求的问题</p>
<p>一个网页的加载时间 80% 是消耗在 css，script，img这些资源的加载，减少请求个数就是优化的关键。而方法也较多，合并css和script文件，CSS Sprites ，baes64图片资源(inline image)等这些方法都是比较流行的.</p>
<h3 id="而减少了网络请求的个数之后，如何让剩下的这些不可避免的网络请求的响应更快呢？">而减少了网络请求的个数之后，如何让剩下的这些不可避免的网络请求的响应更快呢？</h3><p>常见的方法有：</p>
<ol>
<li>减少DNS查询个数（合适安排domain个数，DNS查询时间在移动端还是又较为显著的影响）</li>
<li>避免页面跳转</li>
<li>缓存ajax</li>
<li>使用cdn</li>
<li>开启gzip</li>
<li>减少cookie大小（目的也是为了减少http请求的大小，避免分包发送）</li>
<li>图片延迟加载（减少请求数目，避免阻塞，目前大多数站点均有采用）</li>
<li>使用cookie无关的域名来传输静态内容（减少Header的大小）</li>
<li>application cache等缓存静态资源</li>
</ol>
<p>如果文件都加载下来了，下面会影响性能的就是css和javascript这两块了。主要是很多最佳实践的东西，这里就不写了。</p>
<h3 id="关于浏览器在网络处理这一块的资料">关于浏览器在网络处理这一块的资料</h3><p>关于UC浏览器在网络请求并发数的一些问题，向内核组的同学咨询之后，大概总结如下</p>
<p>一个Host下面的并发数是20个，host越多，并发数越大</p>
<p>并发总数 = Host数目 * 20</p>
<p>然而真实的并发数与具体环境的网络并发数也是相关的，android和ios，或者塞班，可能都会有所差别。</p>
<p>一个http请求在大多数网络，一个包最多可承载的数据长度是1388字节，如果超出会被分成多个包；如果可以把每个请求限制在1388个字节之内，那么就减少请求的开销。</p>
<p>不过这个1388的数值，在其他国家或地区可能会有差别。这个暂时无具体数据可以提供。</p>
<p>参考：</p>
<ol>
<li><a href="https://developers.google.com/speed/docs/best-practices/request?hl=zh-CN&amp;csw=1" target="_blank" rel="external">https://developers.google.com/speed/docs/best-practices/request?hl=zh-CN&amp;csw=1</a></li>
<li><a href="http://www.zhihu.com/question/21057713" target="_blank" rel="external">http://www.zhihu.com/question/21057713</a></li>
<li><a href="http://mobile.smashingmagazine.com/2013/04/03/build-fast-loading-mobile-website/" target="_blank" rel="external">http://mobile.smashingmagazine.com/2013/04/03/build-fast-loading-mobile-website/</a> （推荐）</li>
<li><a href="http://mobile.smashingmagazine.com/2013/08/12/creating-high-performance-mobile-websites/" target="_blank" rel="external">http://mobile.smashingmagazine.com/2013/08/12/creating-high-performance-mobile-websites/</a></li>
<li><a href="https://github.com/cssmagic/blog/issues/20" target="_blank" rel="external">https://github.com/cssmagic/blog/issues/20</a></li>
<li><a href="http://51degrees.mobi/ressinfographic" target="_blank" rel="external">http://51degrees.mobi/ressinfographic</a> </li>
<li><a href="http://www.infoq.com/cn/articles/front-end-engineering-and-performance-optimization-part1" target="_blank" rel="external">http://www.infoq.com/cn/articles/front-end-engineering-and-performance-optimization-part1</a></li>
<li><a href="http://www.infoq.com/cn/articles/front-end-engineering-and-performance-optimization-part2" target="_blank" rel="external">http://www.infoq.com/cn/articles/front-end-engineering-and-performance-optimization-part2</a></li>
<li><a href="http://velocity.oreilly.com.cn/2013/index.php?func=session&amp;id=14" target="_blank" rel="external">http://velocity.oreilly.com.cn/2013/index.php?func=session&amp;id=14</a> (里面的PPt不错)</li>
<li><a href="http://www.cnblogs.com/developersupport/p/3248695.html" target="_blank" rel="external">http://www.cnblogs.com/developersupport/p/3248695.html</a> (推荐﻿)  </li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://zhangmhao.github.io/2013/10/15/前端性能优化总结/" data-id="ciepbvo4900431bw106x5c2uz" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dom/">dom</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/性能优化/">性能优化</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Cookie操作" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2013/10/12/Cookie操作/" class="article-date">
  <time datetime="2013-10-11T16:00:00.000Z" itemprop="datePublished">2013-10-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/前端开发/">前端开发</a>
  </div>

  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="获取所有cookie">获取所有cookie</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> allCookies = <span class="built_in">document</span>.cookie;</span><br></pre></td></tr></table></figure>
<p>返回格式是 : “name=andrew; address=Guangzhou;”</p>
<h3 id="设置新的cookie">设置新的cookie</h3><p>cookie不能有分号，逗号，空格，所以可以使用encodeURIComponent对字符串进行处理</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.cookie = updatedCookie;</span><br><span class="line"><span class="built_in">document</span>.cookie = <span class="string">"version="</span> + <span class="built_in">encodeURIComponent</span>(<span class="built_in">document</span>.lastModified);</span><br></pre></td></tr></table></figure>
<p>这个赋值操作是一个增量，不会覆盖原来的cookie,例如</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.cookie = <span class="string">'home=Chaozhou'</span>; <span class="regexp">//</span>这时<span class="built_in">document</span>.cookie的值是<span class="string">"name=andrew; address=Guangzhou; home=Chaozhou"</span></span><br></pre></td></tr></table></figure>
<h3 id="检测cookie是否启用">检测cookie是否启用</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">navigator</span><span class="class">.cookieEnabled</span></span><br></pre></td></tr></table></figure>
<p>这个接口有些浏览器不支持 ，不支持的就直接操作cookie来判断其支持</p>
<h3 id="Cookie的生存周期">Cookie的生存周期</h3><p>当用户退出浏览器，cookie的生命就结束了，这里区别于sessionStorage，因为cookie的范围不限制与一个浏览器窗口或者tab页，而且生命周期与浏览器进程同生共死</p>
<p><code>max-age</code> 设置了cookie的生存周期，浏览器会将cookie保存在文件中，直到过期了再删除。</p>
<h4 id="Cookie的Scope">Cookie的Scope</h4><p>这个是一段对cookie scope的描述</p>
<blockquote>
<p>Google’s Browser Security Handbook says: by default, cookie scope is limited to all URLs on the current host name - and not bound to port or protocol information. and some lines later There is no way to limit cookies to a single DNS name only […] likewise, there is no way to limit them to a specific port. (Also, keep in mind, that IE does not factor port numbers into its same-origin policy at all.) </p>
</blockquote>
<p>也就是说，cookie只受到 <code>domian</code> 和 <code>path</code>的限制，与protocol (https或者http)和 port(端口号)是不相关的，也就是说，以下3个网站读取的都是同一个cookie</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">https:</span><span class="comment">// www.example.com</span></span><br><span class="line"><span class="string">http:</span><span class="comment">//www.example.com</span></span><br><span class="line"><span class="string">http:</span><span class="comment">//www.example.com:123</span></span><br></pre></td></tr></table></figure>
<p>在 <a href="http://www.example.com/catalog/index.html" target="_blank" rel="external">http://www.example.com/catalog/index.html</a> 创建一个cookie之后，对于下面两个网址是可见的：</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/www.example.com/catalog</span><span class="regexp">/order.html  </span><br><span class="line">http:/</span><span class="regexp">/www.example.com/catalog</span><span class="regexp">/widgets/index</span>.html,</span><br></pre></td></tr></table></figure>
<p>但是对于下面这个网址是不可见的，因为path不同</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">http:</span><span class="comment">//www.example.com/about.html.</span></span><br></pre></td></tr></table></figure>
<p>如果将path设置为’/‘ 则对于整个 <a href="http://www.example.com都是可见的,这样子就有点类似与localStorage，而且所有请求都会带上该cookie" target="_blank" rel="external">http://www.example.com都是可见的,这样子就有点类似与localStorage，而且所有请求都会带上该cookie</a></p>
<p>设置domain属性，可以在子域名上共享cookie。例如</p>
<p>如果要让 order.example.com可以读取 category.example.com 设置的cookie，那就要让选项如下</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="setting">path=<span class="value"><span class="string">'/'</span></span></span></span><br><span class="line"><span class="setting">domain=<span class="value"><span class="string">'.example.com'</span></span></span></span><br></pre></td></tr></table></figure>
<p>最后一个选项是 secure  设置是否是否仅仅通过 https请求</p>
<h3 id="简单的几个函数，辅助Cookie操作">简单的几个函数，辅助Cookie操作</h3><h4 id="Get_Cookie">Get Cookie</h4><p><strong>方法1: 简单，通过正则表达式来进行查找目标</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCookie</span>(<span class="params">k,r</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (r=<span class="built_in">RegExp</span>(<span class="string">'(^|; )'</span>+ <span class="built_in">encodeURIComponent</span>(k) + <span class="string">'=([^;]*)'</span>).exec(<span class="built_in">document</span>.cookie)) ? r[<span class="number">2</span>] : <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>方法2: 分割字符串</strong></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCookie</span><span class="params">(name)</span> &#123;</span></span><br><span class="line">    name += <span class="string">'='</span>;</span><br><span class="line">    <span class="keyword">for</span> (var ca = document.cookie.split(/;\s*/), <span class="built_in">i</span> = ca.<span class="built_in">length</span> - <span class="number">1</span>; <span class="built_in">i</span> &gt;= <span class="number">0</span>; <span class="built_in">i</span>--)</span><br><span class="line">        <span class="keyword">if</span> (!ca<span class="matrix">[i]</span>.indexOf(name))</span><br><span class="line">            <span class="keyword">return</span> ca<span class="matrix">[i]</span>.replace(name, <span class="string">''</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>方法3: 建立Hash Map</strong></p>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="list">(<span class="keyword">function</span><span class="list">()</span><span class="collection">&#123;</span><br><span class="line">    var cookies;</span><br><span class="line"></span><br><span class="line">    function getCookie<span class="list">(<span class="keyword"><span class="built_in">name</span></span>, c, C, i)</span><span class="collection">&#123;</span><br><span class="line">        if<span class="list">(<span class="keyword">cookies</span>)</span><span class="collection">&#123; return cookies<span class="collection">[name]</span><span class="comment">; &#125;</span></span><br><span class="line"></span><br><span class="line">        c = document.cookie.split<span class="list">(<span class="keyword">';</span> ')</span><span class="comment">;</span></span><br><span class="line">        cookies = <span class="collection">&#123;&#125;</span><span class="comment">;</span></span><br><span class="line"></span><br><span class="line">        for<span class="list">(<span class="keyword">i</span> = c.length-1; i&gt;=0; i--)</span><span class="collection">&#123;</span><br><span class="line">           C = c<span class="collection">[i]</span>.split<span class="list">(<span class="keyword">'='</span>)</span><span class="comment">;</span></span><br><span class="line">           cookies<span class="collection">[C<span class="collection">[<span class="number">0</span>]</span>]</span> = C<span class="collection">[<span class="number">1</span>]</span><span class="comment">;</span></span><br><span class="line">        &#125;</span></span><br><span class="line"></span><br><span class="line">        return cookies<span class="collection">[name]</span><span class="comment">;</span></span><br><span class="line">    &#125;</span></span><br><span class="line"></span><br><span class="line">    //暴露接口</span><br><span class="line">    window.getCookie = getCookie</span><br><span class="line">&#125;</span>)<span class="list">()</span><span class="comment">;</span></span></span></span><br></pre></td></tr></table></figure>
<h4 id="Set_Cookie">Set Cookie</h4><p><strong>方法1: 稍微简单</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setCookie</span>(<span class="params">name, value, days</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (days) &#123;</span><br><span class="line">        <span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">        date.setTime(date.getTime() + (days * <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span>));</span><br><span class="line">        <span class="keyword">var</span> expires = <span class="string">"; expires="</span> + date.toGMTString();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">var</span> expires = <span class="string">""</span>;</span><br><span class="line">    <span class="built_in">document</span>.cookie = name + <span class="string">"="</span> + value + expires + <span class="string">"; path=/"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>方法2: 更加完善的，来自<a href="https://developer.mozilla.org/en-US/docs/Web/API/document.cookie" target="_blank" rel="external">MDN</a></strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setCookie</span>(<span class="params">sKey, sValue, vEnd, sPath, sDomain, bSecure</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!sKey || <span class="regexp">/^(?:expires|max\-age|path|domain|secure)$/i</span>.test(sKey)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> sExpires = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">if</span> (vEnd) &#123;</span><br><span class="line">        <span class="keyword">switch</span> (vEnd.constructor) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="built_in">Number</span>:</span><br><span class="line">                sExpires = vEnd === <span class="literal">Infinity</span> ? <span class="string">"; expires=Fri, 31 Dec 9999 23:59:59 GMT"</span> : <span class="string">"; max-age="</span> + vEnd;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="built_in">String</span>:</span><br><span class="line">                sExpires = <span class="string">"; expires="</span> + vEnd;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="built_in">Date</span>:</span><br><span class="line">                sExpires = <span class="string">"; expires="</span> + vEnd.toUTCString();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">document</span>.cookie = <span class="built_in">encodeURIComponent</span>(sKey) + <span class="string">"="</span> + <span class="built_in">encodeURIComponent</span>(sValue) + sExpires + (sDomain ? <span class="string">"; domain="</span> + sDomain : <span class="string">""</span>) + (sPath ? <span class="string">"; path="</span> + sPath : <span class="string">""</span>) + (bSecure ? <span class="string">"; secure"</span> : <span class="string">""</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>或者更加完善的操作可以参考 <code>jquery.cookie.js</code>的代码</p>
<h3 id="参考">参考</h3><ol>
<li>url定义：<a href="https://dvcs.w3.org/hg/url/raw-file/tip/Overview.html#urls" target="_blank" rel="external">https://dvcs.w3.org/hg/url/raw-file/tip/Overview.html#urls</a></li>
<li><a href="http://www.w3.org/TR/WD-html40-970708/htmlweb.html" target="_blank" rel="external">http://www.w3.org/TR/WD-html40-970708/htmlweb.html</a> </li>
<li><a href="http://www.quirksmode.org/js/cookies.html" target="_blank" rel="external">http://www.quirksmode.org/js/cookies.html</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/document.cookie" target="_blank" rel="external">https://developer.mozilla.org/en-US/docs/Web/API/document.cookie</a></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://zhangmhao.github.io/2013/10/12/Cookie操作/" data-id="ciepbvo4i004e1bw189ok7jg1" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cookie/">cookie</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-DOM-and-BOM" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2013/09/05/DOM-and-BOM/" class="article-date">
  <time datetime="2013-09-04T16:00:00.000Z" itemprop="datePublished">2013-09-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/前端开发/">前端开发</a>
  </div>

  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="BOM是什么？">BOM是什么？</h3><p>要在网页中使用javascript来访问浏览器，就必须通过BOM提供的对象。window有双重角色，访问浏览器的接口，又是ECMAScript定义的Global对象<br>其中window对象包含 location,navigator,screen,history</p>
<p>###DOM是什么？</p>
<p>DOM是HTML和XML的API， 将页面和脚本（编程语言）连接在一起. 开发过程中用来操作页面的 event，methods，property，全都被封装在一个个的Object里面，DOM经常和javascript结合在一起，但是这是DOM是一个API，他是独立于编程语言之外的，DOM接口的实现可以基于任意语言.<br>DOM其中包含了CSSOM，说白了就是CSS Object Model， style Obejct暴露出Stylesheet和 CSSStyleSheet 的接口.通过 document.styleSheets 通过index可以获取到每一个CSSStyleSheet, 例如  <code>document.styleSheets[0]</code> 获取到的是页面第一个定义的stylesheet 更加详细参考CSS Reference：<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Reference?redirectlocale=en-US&amp;redirectslug=CSS%2FCSS_Reference" target="_blank" rel="external">https://developer.mozilla.org/en-US/docs/Web/CSS/Reference?redirectlocale=en-US&amp;redirectslug=CSS%2FCSS_Reference</a> </p>
<p>Dom Style Object 是每一个html元素上样式的Object，这个与document.styleSheets这个集合是不一样的<br>document.getElementById(‘d’).style.color = ‘orange’;</p>
<p>DOM另外一个重要的就是DOM Event，浏览器丰富的交互就是得益于事件的响应  参考DOM event reference</p>
<p>###参考：</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/DOM" target="_blank" rel="external">DOM的介绍</a></li>
<li><a href="http://www.w3.org/DOM/" target="_blank" rel="external">DOM的定义</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/DOM/DOM_Reference" target="_blank" rel="external">DOM API查询</a></li>
<li><a href="http://ejohn.org/blog/the-dom-is-a-mess/" target="_blank" rel="external">John Resig the dom is a mess</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://zhangmhao.github.io/2013/09/05/DOM-and-BOM/" data-id="ciepbvo4g004b1bw1nv5zy6mr" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dom/">dom</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-LocalStorage-and-SessionStorage" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2013/08/27/LocalStorage-and-SessionStorage/" class="article-date">
  <time datetime="2013-08-26T16:00:00.000Z" itemprop="datePublished">2013-08-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/前端开发/">前端开发</a>
  </div>

  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="相同点">相同点</h2><p>两者都是web storage的定义，已key value的形式保存数据，安装草案，应该是可以存储有结构的数据，例如Object，原始类型，正则表达式等，但是现阶段只能存储字符串。如果要保存非字符串，就需要自己进行encode和decode了</p>
<h2 id="异同点">异同点</h2><p>两种的区别在与生存周期(lifetimes) 和 域(scope)的差别</p>
<h3 id="lifetimes">lifetimes</h3><p>localStorage: 永久，除非主动删除或者用户要求浏览器删除<br>sessionStorage: 浏览器窗口或者Tab关闭，就会清除</p>
<h3 id="scope">scope</h3><p>文档域定义： protocol, hostname, and port， localStorage和sessionStorage的域都是文档域，但是sessionStorage的域同时受到窗口或者Tab页的限制，也就是说，处于同一个文档域的不同浏览器Tab页（窗口）是持有不用sesstionStorage的</p>
<p>所以以下网站保存的localStorage都是独立的</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">http:</span><span class="comment">//www.example.com        // Protocol: http; hostname: www.example.com</span></span><br><span class="line"><span class="string">https:</span><span class="comment">//www.example.com       // Different protocol</span></span><br><span class="line"><span class="string">http:</span><span class="comment">//static.example.com     // Different hostname</span></span><br><span class="line"><span class="string">http:</span><span class="comment">//www.example.com:8000   // Different port</span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://zhangmhao.github.io/2013/08/27/LocalStorage-and-SessionStorage/" data-id="ciepbvo4d00481bw1qqjg9cr3" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Javascript-Callback-Soup" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2013/08/12/Javascript-Callback-Soup/" class="article-date">
  <time datetime="2013-08-11T16:00:00.000Z" itemprop="datePublished">2013-08-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/前端开发/">前端开发</a>
  </div>

  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="什么是callback？">什么是callback？</h3><blockquote>
<p>Callbacks are functions that are executed asynchronously, or at a later time. Instead of the code reading top to bottom procedurally, async programs may execute different functions at different times based on the order and speed that earlier functions like http requests or file system reads happen.</p>
</blockquote>
<p>下面就是一段 多个callback嵌套的代码例子， 难读懂，可维护性差;</p>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function mainFunction() &#123;</span><br><span class="line">   getData(function(err, <span class="literal">result</span>) &#123;</span><br><span class="line">      getMoreData(<span class="literal">result</span>, function(err2, moreResults) &#123;</span><br><span class="line">          finallyGetLastData(&#123;first: <span class="literal">result</span>, second: moreResults&#125;, function(err3, finalResults) &#123;</span><br><span class="line">               //<span class="type">Do</span> something <span class="keyword">with</span> all the results here...</span><br><span class="line">          &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">   &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>###解决办法：</p>
<h4 id="组织好函数,给函数命名">组织好函数,给函数命名</h4><p><strong>好处：</strong></p>
<ul>
<li>易读，易理解</li>
<li>发生异常的时候可以从 stack traces看到真正的函数名，而不是 “anonymous”匿名函数</li>
</ul>
<p>allows you to keep your code shallow, or not nested deeply, which brings me to my next point:</p>
<p>#####修改前：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> form = <span class="built_in">document</span>.querySelector(<span class="string">'form'</span>)</span><br><span class="line">form.onsubmit = <span class="function"><span class="keyword">function</span>(<span class="params">submitEvent</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> name = <span class="built_in">document</span>.querySelector(<span class="string">'input'</span>).value</span><br><span class="line">  request(&#123;</span><br><span class="line">    uri: <span class="string">"http://example.com/upload"</span>,</span><br><span class="line">    body: name,</span><br><span class="line">    method: <span class="string">"POST"</span></span><br><span class="line">  &#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err, response, body</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> statusMessage = <span class="built_in">document</span>.querySelector(<span class="string">'.status'</span>)</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">return</span> statusMessage.value = err</span><br><span class="line">    statusMessage.value = body</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="修改后：">修改后：</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">formSubmit</span>(<span class="params">submitEvent</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> name = <span class="built_in">document</span>.querySelector(<span class="string">'input'</span>).value</span><br><span class="line">  request(&#123;</span><br><span class="line">    uri: <span class="string">"http://example.com/upload"</span>,</span><br><span class="line">    body: name,</span><br><span class="line">    method: <span class="string">"POST"</span></span><br><span class="line">  &#125;, postResponse)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">postResponse</span>(<span class="params">err, response, body</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> statusMessage = <span class="built_in">document</span>.querySelector(<span class="string">'.status'</span>)</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> statusMessage.value = err</span><br><span class="line">  statusMessage.value = body</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="built_in">document</span>.querySelector(<span class="string">'form'</span>).onsubmit = formSubmit</span><br></pre></td></tr></table></figure>
<h4 id="(Partial_functions)http://en-wikipedia-org/wiki/Partial_function">(Partial functions)<a href="http://en.wikipedia.org/wiki/Partial_function" target="_blank" rel="external">http://en.wikipedia.org/wiki/Partial_function</a></h4><p><strong>partial函数的例子</strong>：</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span><span class="params">(a, b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add5</span><span class="params">(b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> add.apply(<span class="literal">null</span>,[<span class="number">5</span>,b]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用这个例子来partial函数来简化过程</p>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">function getData(cb) &#123;</span><br><span class="line">    cb(null, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">function getMoreData(param, cb) &#123;</span><br><span class="line">    cb(null, param + <span class="number">1</span>); //<span class="type">We</span> don't really care about the <span class="string">"result"</span> variable</span><br><span class="line">&#125;</span><br><span class="line">function finallyGetLastData(opts, cb) &#123;</span><br><span class="line">    cb(null, <span class="number">400</span>); //<span class="type">We</span> don't care about <span class="string">"result"</span> <span class="keyword">or</span> <span class="string">"changedResults"</span>, the callback will already have them pre-<span class="type">set</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">function finallyGetLastDataCB(<span class="literal">result</span>, changedResults, err, finalResults) &#123;</span><br><span class="line">        <span class="keyword">var</span> diff = changedResults - <span class="literal">result</span>;</span><br><span class="line">        console.log(<span class="string">"Result: "</span> + <span class="literal">result</span> + <span class="string">" - Final Result: "</span> + finalResults);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">function getMoreDataCB(<span class="literal">result</span>, err, moreResults) &#123;</span><br><span class="line">   <span class="keyword">var</span> changedResults = <span class="literal">result</span> * <span class="number">2</span>;</span><br><span class="line">   finallyGetLastData(&#123;</span><br><span class="line">            first : <span class="literal">result</span>,</span><br><span class="line">            second : moreResults</span><br><span class="line">    &#125;, partial(finallyGetLastDataCB, [<span class="literal">result</span>, changedResults]));</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">function mainFunction() &#123;</span><br><span class="line">    getData(function(err, <span class="literal">result</span>)&#123;</span><br><span class="line">        getMoreData(<span class="literal">result</span>, partial(getMoreDataCB, [<span class="literal">result</span>]));</span><br><span class="line">   &#125;);</span><br><span class="line">&#125;</span><br><span class="line">function partial(func, args) &#123;</span><br><span class="line">    <span class="keyword">return</span> function()&#123; </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">in</span> arguments) &#123;</span><br><span class="line">            args.push(arguments[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> func.apply(this, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="参考：">参考：</h3><ol>
<li>介绍callback <a href="https://github.com/maxogden/art-of-node#callbacks" target="_blank" rel="external">https://github.com/maxogden/art-of-node#callbacks</a> </li>
<li>如何让callback不那么恐怖：<a href="http://callbackhell.com/" target="_blank" rel="external">http://callbackhell.com/</a></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://zhangmhao.github.io/2013/08/12/Javascript-Callback-Soup/" data-id="ciepbvo4l004i1bw16nt33h3s" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/3/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/5/">Next &raquo;</a>
    </nav>
  
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Life-Style/">Life Style</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/UI界面/">UI界面</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Unix/">Unix</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/html/">html</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/node-webkit/">node-webkit</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端开发/">前端开发</a><span class="category-list-count">19</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/学习研究/">学习研究</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工具/">工具</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/开发/">开发</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/心理学/">心理学</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/性能监控/">性能监控</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/模塊化/">模塊化</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/生活/">生活</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/编程/">编程</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/设计/">设计</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/读书笔记/">读书笔记</a><span class="category-list-count">2</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AMD/">AMD</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CMD/">CMD</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Com/">Com</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Day-Study/">Day Study</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/W3C/">W3C</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/api/">api</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cookie/">cookie</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/">css</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dom/">dom</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/haskell/">haskell</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/html5/">html5</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http协议/">http协议</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node/">node</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/restful/">restful</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/">shell</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vim/">vim</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端开发/">前端开发</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端性能优化/">前端性能优化</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端组件化/">前端组件化</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/复杂系统/">复杂系统</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/工具开发/">工具开发</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/性能优化/">性能优化</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/总结/">总结</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/时间管理/">时间管理</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/模塊化/">模塊化</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/测试/">测试</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/生活优化/">生活优化</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/用戶交互/">用戶交互</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/编程语言/">编程语言</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计/">设计</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/读书笔记/">读书笔记</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/项目文档/">项目文档</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/AMD/" style="font-size: 10px;">AMD</a> <a href="/tags/CMD/" style="font-size: 10px;">CMD</a> <a href="/tags/Com/" style="font-size: 10px;">Com</a> <a href="/tags/Day-Study/" style="font-size: 16.67px;">Day Study</a> <a href="/tags/W3C/" style="font-size: 10px;">W3C</a> <a href="/tags/api/" style="font-size: 10px;">api</a> <a href="/tags/cookie/" style="font-size: 10px;">cookie</a> <a href="/tags/css/" style="font-size: 10px;">css</a> <a href="/tags/dom/" style="font-size: 13.33px;">dom</a> <a href="/tags/haskell/" style="font-size: 10px;">haskell</a> <a href="/tags/html5/" style="font-size: 10px;">html5</a> <a href="/tags/http协议/" style="font-size: 10px;">http协议</a> <a href="/tags/javascript/" style="font-size: 20px;">javascript</a> <a href="/tags/node/" style="font-size: 10px;">node</a> <a href="/tags/restful/" style="font-size: 10px;">restful</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/vim/" style="font-size: 10px;">vim</a> <a href="/tags/前端开发/" style="font-size: 13.33px;">前端开发</a> <a href="/tags/前端性能优化/" style="font-size: 16.67px;">前端性能优化</a> <a href="/tags/前端组件化/" style="font-size: 10px;">前端组件化</a> <a href="/tags/复杂系统/" style="font-size: 10px;">复杂系统</a> <a href="/tags/工具开发/" style="font-size: 10px;">工具开发</a> <a href="/tags/性能优化/" style="font-size: 16.67px;">性能优化</a> <a href="/tags/总结/" style="font-size: 10px;">总结</a> <a href="/tags/时间管理/" style="font-size: 10px;">时间管理</a> <a href="/tags/模塊化/" style="font-size: 10px;">模塊化</a> <a href="/tags/测试/" style="font-size: 10px;">测试</a> <a href="/tags/生活优化/" style="font-size: 10px;">生活优化</a> <a href="/tags/用戶交互/" style="font-size: 10px;">用戶交互</a> <a href="/tags/编程语言/" style="font-size: 16.67px;">编程语言</a> <a href="/tags/设计/" style="font-size: 10px;">设计</a> <a href="/tags/读书笔记/" style="font-size: 16.67px;">读书笔记</a> <a href="/tags/项目文档/" style="font-size: 10px;">项目文档</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">June 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">May 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">April 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">March 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">January 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">October 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">September 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/07/">July 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06/">June 2014</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/05/">May 2014</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/04/">April 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/03/">March 2014</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/02/">February 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/01/">January 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/12/">December 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/11/">November 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/10/">October 2013</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/09/">September 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/08/">August 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/03/">March 2013</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2015/06/04/Haskell入门笔记/">(no title)</a>
          </li>
        
          <li>
            <a href="/2015/05/05/You-don't-know-js--Async-and-Performance-读书笔记/">(no title)</a>
          </li>
        
          <li>
            <a href="/2015/04/12/Life-time-tracker表达的理念/">(no title)</a>
          </li>
        
          <li>
            <a href="/2015/03/31/关于Javascript以前忽略的性能问题/">(no title)</a>
          </li>
        
          <li>
            <a href="/2015/03/24/Min-和-Max方法的实现和用法/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2015 Andrew Zhang<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>